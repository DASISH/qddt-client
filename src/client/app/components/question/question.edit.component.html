<div *ngIf="questionitem && isVisible"  class="card white grey-text text-darken-1">
  <qddt-preview-responsedomain
    *ngIf="questionitem?.responseDomain"
    [responseDomain]="questionitem.responseDomain">
  </qddt-preview-responsedomain>

  <qddt-conceptref [element]="questionitem"></qddt-conceptref>

  <div class="card-action">
    <form  (ngSubmit)="onSaveQuestionItem()" #questionEditForm="ngForm">
      <div class="row input-field">
        <label [attr.for]="questionitem.id + '-name'" class="teal-text">Name</label>
        <input
          name="{{questionitem?.id}}-name"
          type="text"
          class="validate" required
          [(ngModel)]="questionitem.name"
          materialize="characterCounter" data-length="255">
      </div>
      <div class="row ">
           <!--(mouseenter)="showbuttonX = true"-->
           <!--(mouseleave)="showbuttonX = false" href="#showbuttonX"-->
      <!--&gt;-->
        <div class="col s12 input-field">
          <label [attr.for]="questionitem.id + '-textarea'" class="teal-text">Question text</label>
          <textarea id="{{questionitem?.id}}-textarea"
                    name="{{questionitem?.id}}-textarea" [(ngModel)]="questionitem.question.question"
                    class="materialize-textarea validate" required minlength="5"
                    materialize="characterCounter" data-length="1500">
          </textarea>
        </div>
        <div class="row">
          <div class="col s11 input-field">
              <label [attr.for]="questionitem.id + '-intent'" class="teal-text">Question intent</label>
              <textarea id="{{questionitem?.id}}-intent"
                        name="{{questionitem?.id}}-intent" [(ngModel)]="questionitem.question.intent"
                        class="materialize-textarea validate"
                        materialize="characterCounter" data-length="2000">
              </textarea>
          </div>
          <div class="col s1">
          <a *ngIf="false" class="btn-flat btn-floating btn-small waves-effect waves-light teal">
            <i class="material-icons" title="Add question below" (click)="onAddQuestion()">add</i>
          </a>
        </div>
        </div>
      </div>
      <div class="row hoverable" *ngFor="let child of questionitem.question.children; let idx=index"
           (mouseenter)="child.showbutton = true"
           (mouseleave)="child.showbutton = false">
        <div class="col s1">
          <a *ngIf="child.showbutton" class="btn-flat btn-floating btn-small waves-effect waves-light teal">
            <i class="material-icons" title="Remove this question" (click)="onRemoveQuestion(idx)">remove</i>
          </a>
        </div>
        <div class="col s11 input-field">
          <label [attr.for]="questionitem.id + '-textarea'+idx" class="teal-text">Question text</label>
          <textarea id="{{questionitem?.id}}-textarea{{idx}}"
                    name="{{questionitem?.id}}-textarea{{idx}}" [(ngModel)]="child.question"
                    class="materialize-textarea validate" required minlength="5"
                    materialize="characterCounter" data-length="1500">
          </textarea>
        </div>
        <div class="col s11 offset-s1 input-field">
          <label [attr.for]="questionitem.id + '-intent'+idx" class="teal-text">Question intent</label>
          <textarea id="{{questionitem?.id}}-intent{{idx}}"
                    name="{{questionitem?.id}}-intent{{idx}}" [(ngModel)]="child.intent"
                    class="materialize-textarea validate"
                    materialize="characterCounter" data-length="2000">
            </textarea>
        </div>
      </div>
      <div class="row hoverable"
           (mouseenter)="showbutton = true"
           (mouseleave)="showbutton = false">
        <div class="col s8">
          <div class="row teal-text">
            <span>Response Domain (V <qddt-version [element]="questionitem?.responseDomain?.managedRepresentation"></qddt-version>)
            </span>
          </div>
          <div class="row">
            <qddt-responsedomain-reuse
               [readOnly] = "readonly"
               [modalId] = "'reuse-2'"
               [showbutton] = "showbutton"
               [responseDomain]="questionitem?.responseDomain"
               (responseDomainSelected)="onResponseDomainSelected($event)"
               (responseDomainRemove)="onResponsedomainRemove($event)">
            </qddt-responsedomain-reuse>
          </div>
        </div>
        <div class="col s4">
            <qddt-responsedomain-select-missing
              *ngIf="!readonly && questionitem?.responseDomain"
              [modalId] = "'select-missing-2'"
              [responseDomain]="questionitem.responseDomain"
              (responseDomainSelected)="onResponseDomainSelected($event)"
              (responseDomainRemove)="onResponsedomainRemove($event)">
            </qddt-responsedomain-select-missing>
        </div>
      </div>
      <!--<div class="row" *ngIf="!readonly">-->
      <qddt-rational
        *ngIf="!readonly"
        [element]="questionitem"
        [config]="{hidden: [4]}">
      </qddt-rational>
      <!--</div>-->
      <!--<div class="row">-->
      <qddt-element-footer
        [element]="questionitem"
        [type]="'QUESTION_ITEM'"
        (BasedonObjectDetail)="onBasedonObjectDetail($event)">
      </qddt-element-footer>
      <!--</div>-->
      <div class="row right-align">
        <button *ngIf="!readonly"
                [disabled]="!questionEditForm.form.valid"
                type="submit" class="btn btn-default">Submit
        </button>
      </div>
    </form>
  </div>
</div>


<div class="modal modal-fixed-footer" id="'based-on-1"
     materialize="modal" [materializeActions]="basedonActions">
  <div class="modal-content">
    <h4>Basedon Object Detail</h4>
    <div class="row" *ngIf="basedonObject">
      <qddt-preview-questionitem [questionItem]="basedonObject"></qddt-preview-questionitem>
    </div>
  </div>
  <div class="modal-footer">
    <button id="controlConstructs-modal-close"
            class="btn btn-default red modal-action modal-close waves-effect">
      <a><i class="close material-icons medium white-text">close</i></a>
    </button>
  </div>
</div>
