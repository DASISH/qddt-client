<div *ngIf="concept && concept.name" class="row card">
  <div id="{{concept.id}}" class="scrollspy">

    <div class="fixed-action-btn vertical click-to-toggle">
      <a class="btn-floating btn-large teal"><i class="large material-icons">menu</i></a>
      <ul>
        <li><a class="btn-flat btn-floating btn-medium waves-effect waves-light blue" (click)="revisionIsVisible = !revisionIsVisible">
          <i class="material-icons left medium" title="Revision history">history</i></a></li>
        <li><qddt-questionitem-reuse [parentId]="concept.id"
                                 (questionItemCreatedEvent)="setQuestionItem($event)"></qddt-questionitem-reuse>
        </li>
        <li><a class="btn-flat btn-floating btn-medium waves-effect waves-light teal"
           (click)="onCreateConcept(concept)"><i class="material-icons left medium">add</i>
        </a></li>
        <li><a class="btn-flat btn-floating btn-medium waves-effect waves-light red">
        <i class="material-icons" (click)="onDeleteConcept(concept)" title="Delete" >delete_forever</i>
        </a></li>
        <li><a class="btn-flat btn-floating btn-medium waves-effect waves-light green darken-1">
          <i class="material-icons" (click)="hideDetail()" title="Return to list view">replay</i>
        </a></li>
      </ul>
    </div>

    <div class="col s1">
      <a class="btn-flat btn-floating btn-medium waves-effect waves-light  green darken-1">
        <i class="material-icons" (click)="hideDetail()" title="Return to list view">replay</i>
      </a>
    </div>

    <div class="col s11 grey-text text-darken-2">
      <h5>{{concept.name}}</h5>
      {{concept.modified | localDate}} by <strong>{{concept?.modifiedBy?.username}}@{{concept?.modifiedBy?.agency?.name}}</strong>
    </div>

    <div class="col s11 white grey-text text-darken-1">
      <div class="row">
        <p>{{concept.description}}</p>
        <qddt-author-chip [authors]="concept.authors" ></qddt-author-chip>
      </div>
      <div *ngIf="showConceptChildForm">
        <div class="card-action">
          <form (ngSubmit)="onChildSave()" #hf="ngForm">
            <div class="row">
              <div class="input-field col">
                <input id="name" name="name" type="text" [(ngModel)]="newchild.name" required>
                <label for="name" class="blue-text">Name</label>
              </div>
            </div>
            <div class="row">
              <div class="input-field col s11">
                     <textarea id="description" name="description"
                               class="materialize-textarea" [(ngModel)]="newchild.description" required></textarea>
                <label for="description" class="blue-text">Description</label>
              </div>
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
          </form>
        </div>
      </div>
      <qddt-revision [isVisible]="revision.isVisible"
                     [current]="concept"
                     [qddtURI]="'audit/concept/' + concept.id + '/all'" #revision ></qddt-revision>
      <div *ngIf="concept.conceptQuestionItems.length > 0" class="section">
        <ul class="collection with-header">
          <li class="collection-header">Question Items</li>
          <li class="collection-item" *ngFor="let questionItem of concept.conceptQuestionItems">
            <div class="row">
              <div class="col s1">
                <a materialize="leanModal" [materializeParams]="[{dismissible: true}]"
                   class="modal-trigger btn-flat btn-floating btn-medium waves-effect waves-light teal"
                   [attr.href]="'#'+questionItem.id+'-concept-questionitem-modal'">
                  <i class="material-icons">search</i></a>
              </div>
              <div class="col s10">{{questionItem?.question?.question}}</div>
              <div class="col s1">
                <a
                  class="modal-trigger btn-flat btn-floating btn-medium waves-effect waves-light teal"
                  (click)="removeQuestionItem(questionItem?.id)">
                  <i class="material-icons">remove</i>
                </a>
              </div>
            </div>
          </li>
        </ul>
      </div>
      <div class="row">
        <qddt-comment-list [ownerId]="concept.id" [comments]="concept.comments"></qddt-comment-list>
      </div>
      <div class="tree-children">
        <qddt-questionitem-treenode *ngFor="let child of concept.children" [concept]="child"
                                    (deleteConceptEvent)="onDeleteConcept($event)"></qddt-questionitem-treenode>
      </div>
    </div>
  </div>
  <div *ngFor="let questionItem of concept.conceptQuestionItems">
    <div [attr.id]="questionItem.id + '-concept-questionitem-modal'"
         class="modal modal-fixed-footer">
      <div class="modal-footer">
        <button id="questionitem-modal-close"
                class="btn btn-default red modal-action modal-close waves-effect waves-red">
          <i class="close material-icons">close</i>
        </button>
      </div>
      <div class="modal-content">
        <qddt-questionitem-edit [isVisible]="true" [questionitem]="questionItem" [editResponseDomain]="false">
        </qddt-questionitem-edit>
      </div>
    </div>
  </div>
</div>
